#!/usr/bin/env python

import sys
from urllib2 import urlopen
from argparse import ArgumentParser
import xml.etree.ElementTree as ET


def main(args):
    # result = urlopen(args.s3url + "?prefix=" + args.prefix).read()
    result = """<ListBucketResult xmlns="http://s3.amazonaws.com/doc/2006-03-01/"><Name>compiler-explorer</Name><Prefix>opt/</Prefix><Marker></Marker><MaxKeys>1000</MaxKeys><IsTruncated>false</IsTruncated><Contents><Key>opt/</Key><LastModified>2017-01-02T17:02:52.000Z</LastModified><ETag>&quot;d41d8cd98f00b204e9800998ecf8427e&quot;</ETag><Size>0</Size><StorageClass>STANDARD</StorageClass></Contents><Contents><Key>opt/OracleDeveloperStudio12.5-linux-x86-bin.tar.bz2</Key><LastModified>2017-01-02T17:05:24.000Z</LastModified><ETag>&quot;e8358f7e82a262453d0857b26b82737a-7&quot;</ETag><Size>466436988</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/arm-gcc-4.5.4.tar.xz</Key><LastModified>2017-04-09T20:24:43.000Z</LastModified><ETag>&quot;39c5a13dd266546ddf595082cafef8f1-3&quot;</ETag><Size>42679072</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/arm-gcc-4.6.4.tar.xz</Key><LastModified>2017-04-09T20:11:00.000Z</LastModified><ETag>&quot;a7ed60e99881d96cc7629ebdae9df716-3&quot;</ETag><Size>43314780</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/arm-gcc-5.4.0.tar.xz</Key><LastModified>2017-04-12T01:08:17.000Z</LastModified><ETag>&quot;170f49516d21ac9507773899cf540c34-4&quot;</ETag><Size>49921448</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/arm-gcc-6.3.0.tar.xz</Key><LastModified>2017-07-13T15:29:36.000Z</LastModified><ETag>&quot;4ccb7fd07ffa2518c7616acb9268adf3-5&quot;</ETag><Size>64193596</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/arm64-gcc-5.4.0.tar.xz</Key><LastModified>2017-04-12T02:13:13.000Z</LastModified><ETag>&quot;ae632e37d2da9382e8e105db8c233263-4&quot;</ETag><Size>48714272</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/arm64-gcc-6.3.0.tar.xz</Key><LastModified>2017-07-14T03:46:14.000Z</LastModified><ETag>&quot;1d2c3ad40dd470b666313881640a02cd-4&quot;</ETag><Size>60895712</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/avr-gcc-4.5.4.tar.xz</Key><LastModified>2017-04-09T21:05:55.000Z</LastModified><ETag>&quot;882762a66189aae416554de6e01cf7d8-2&quot;</ETag><Size>27762756</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/avr-gcc-4.6.4.tar.xz</Key><LastModified>2017-04-09T22:33:25.000Z</LastModified><ETag>&quot;a56a1a6b123b5d4a26f0d6b9dc0e92c4-2&quot;</ETag><Size>28262532</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/clang-3.2.tar.gz</Key><LastModified>2017-01-02T17:05:24.000Z</LastModified><ETag>&quot;09fd08bf10e6f08e0bf9bdf8716b0c93-2&quot;</ETag><Size>74728166</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/clang-3.3.tar.gz</Key><LastModified>2017-01-02T17:05:24.000Z</LastModified><ETag>&quot;561602b164045a9469b5ae75105611c1-2&quot;</ETag><Size>83351400</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/clang-3.9.1.tar.xz</Key><LastModified>2017-03-02T18:40:57.000Z</LastModified><ETag>&quot;f9703fa0c3b0b75837801806e624caa8-15&quot;</ETag><Size>232578256</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/clang-4.0.0.tar.xz</Key><LastModified>2017-04-09T20:45:37.000Z</LastModified><ETag>&quot;ef7aade848f5e55a2490644c0062379f-20&quot;</ETag><Size>304351812</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/clang-4.0.1.tar.xz</Key><LastModified>2017-08-31T14:09:39.000Z</LastModified><ETag>&quot;5ecdaec9f4e819319062b760d803bc68-20&quot;</ETag><Size>304267576</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/clang-5.0.0.tar.xz</Key><LastModified>2017-09-06T16:04:41.000Z</LastModified><ETag>&quot;cf6f1903c41345910f3139b52031928a-28&quot;</ETag><Size>430848308</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/clang-cppx-20170422.tar.xz</Key><LastModified>2017-04-23T00:13:33.000Z</LastModified><ETag>&quot;9f5437d4d15b119ea33c3e6485660b60-20&quot;</ETag><Size>306569124</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/clang-cppx-20170424.tar.xz</Key><LastModified>2017-04-25T01:50:42.000Z</LastModified><ETag>&quot;706c041bc62f8271e7e1beacd3b08c57-374&quot;</ETag><Size>5882217168</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/clang-cppx-20170425.tar.xz</Key><LastModified>2017-04-25T12:47:19.000Z</LastModified><ETag>&quot;4db1f1d7023037ac2d4c0a5f487035a3-20&quot;</ETag><Size>306562020</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/clang-cppx-20170426.tar.xz</Key><LastModified>2017-04-26T21:55:45.000Z</LastModified><ETag>&quot;e2adaf3ac9a22df85d7e929e7681ea3f-20&quot;</ETag><Size>306557992</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/clang-cppx-20170427.tar.xz</Key><LastModified>2017-04-27T23:27:10.000Z</LastModified><ETag>&quot;ed5b98f3f6444cdc6908322bc361b6aa-20&quot;</ETag><Size>306539204</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/clang-cppx-20170713.tar.xz</Key><LastModified>2017-07-13T15:27:54.000Z</LastModified><ETag>&quot;ef914c17304870b4651ee617fe1d9036-21&quot;</ETag><Size>320187480</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/clang-cppx-20170720.tar.xz</Key><LastModified>2017-07-20T18:18:46.000Z</LastModified><ETag>&quot;618e3b1c82961da515e885b9ebf9b8b7-21&quot;</ETag><Size>320196216</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/clang-cppx-20170726.tar.xz</Key><LastModified>2017-07-26T13:50:40.000Z</LastModified><ETag>&quot;cac00392fcebaf4b74abb8c6382ae9c7-21&quot;</ETag><Size>320183540</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/clang-trunk-20170919.tar.xz</Key><LastModified>2017-09-19T08:21:49.000Z</LastModified><ETag>&quot;7d08dfbc005255d1a20a3a966ef60e96-24&quot;</ETag><Size>371886224</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/clang-trunk-20170920.tar.xz</Key><LastModified>2017-09-20T08:22:12.000Z</LastModified><ETag>&quot;80c6a051f610d0be3c334a16b36cf195-24&quot;</ETag><Size>372226720</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/clang-trunk-20170921.tar.xz</Key><LastModified>2017-09-21T08:22:25.000Z</LastModified><ETag>&quot;1cc8cd58704b83e81619431e9ed73d1e-24&quot;</ETag><Size>376417996</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/clang-trunk-20170922.tar.xz</Key><LastModified>2017-09-22T08:22:30.000Z</LastModified><ETag>&quot;ca9ca5a8d40f5b0f7d329b7bff57b018-24&quot;</ETag><Size>376665264</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/clang-trunk-20170924.tar.xz</Key><LastModified>2017-09-24T08:22:23.000Z</LastModified><ETag>&quot;7970400dc8d526f5e6f991bc77a735eb-25&quot;</ETag><Size>384815136</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-4.4.7.tar.xz</Key><LastModified>2017-04-11T01:16:20.000Z</LastModified><ETag>&quot;12f1d467a23728f0c373b6ec4043593b-2&quot;</ETag><Size>21903980</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-4.5.3.tar.xz</Key><LastModified>2017-04-10T23:37:46.000Z</LastModified><ETag>&quot;fe1c791ed5c287012441317dd0d5639c-5&quot;</ETag><Size>67488372</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-4.6.4.tar.xz</Key><LastModified>2017-01-22T22:42:27.000Z</LastModified><ETag>&quot;4bb193555647245f765bde1e3965043b-2&quot;</ETag><Size>21907544</Size><StorageClass>STANDARD</StorageClass></Contents><Contents><Key>opt/gcc-4.7.1.tar.xz</Key><LastModified>2017-01-02T17:05:24.000Z</LastModified><ETag>&quot;ac471e3cd79930a85698db78ce175519&quot;</ETag><Size>24945136</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-4.7.2.tar.xz</Key><LastModified>2017-01-02T17:05:24.000Z</LastModified><ETag>&quot;d9e0afa0379e66232fc551c25ce7d39f&quot;</ETag><Size>24220460</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-4.7.3.tar.xz</Key><LastModified>2017-01-02T17:05:24.000Z</LastModified><ETag>&quot;217ce14f2a1a13ba8aee5023145430ee&quot;</ETag><Size>25125464</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-4.7.4.tar.xz</Key><LastModified>2017-01-02T17:05:26.000Z</LastModified><ETag>&quot;2f3fe0e9b7a79273d4c1ed081beb4a95&quot;</ETag><Size>25095616</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-4.8.0.tar.xz</Key><LastModified>2017-01-02T17:05:27.000Z</LastModified><ETag>&quot;68dc85a71221835b01da3a1e8f067c17&quot;</ETag><Size>26106176</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-4.8.1.tar.xz</Key><LastModified>2017-01-02T17:05:27.000Z</LastModified><ETag>&quot;8ca2fd55b3d0540f59cad8bd848e8fd2&quot;</ETag><Size>26119144</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-4.8.2.tar.xz</Key><LastModified>2017-01-02T17:05:27.000Z</LastModified><ETag>&quot;ddda06ca02e2e978ecf1ab09b7f41c7b&quot;</ETag><Size>26127652</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-4.8.3.tar.xz</Key><LastModified>2017-01-02T17:05:29.000Z</LastModified><ETag>&quot;3ff267dd01329564723163c3e6749d42&quot;</ETag><Size>26185720</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-4.8.4.tar.xz</Key><LastModified>2017-01-02T17:05:30.000Z</LastModified><ETag>&quot;a1ca38c21c96612ace3b924d610890bb&quot;</ETag><Size>26086092</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-4.8.5.tar.xz</Key><LastModified>2017-01-02T17:05:30.000Z</LastModified><ETag>&quot;d8d4b0ae3ea6206e46ca45d75ce3c927&quot;</ETag><Size>26099928</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-4.9.0.tar.xz</Key><LastModified>2017-01-02T17:05:31.000Z</LastModified><ETag>&quot;ddd7f33a52b9dbb920b060ee10a89045&quot;</ETag><Size>31220020</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-4.9.1.tar.xz</Key><LastModified>2017-01-02T17:05:32.000Z</LastModified><ETag>&quot;c22227996fb27c23487a78d88119a991&quot;</ETag><Size>31202056</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-4.9.2.tar.xz</Key><LastModified>2017-01-02T17:05:32.000Z</LastModified><ETag>&quot;38579865c913a5ee4fe4a6389e08f13d&quot;</ETag><Size>31236212</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-4.9.3.tar.xz</Key><LastModified>2017-01-02T17:05:32.000Z</LastModified><ETag>&quot;5d4d0ce325997e7e0bf4449374cb2a69&quot;</ETag><Size>31290200</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-4.9.4.tar.xz</Key><LastModified>2017-04-15T01:12:36.000Z</LastModified><ETag>&quot;cccfee86123a255ef56cf2e94a34c8ba-3&quot;</ETag><Size>45292328</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-5.1.0.tar.xz</Key><LastModified>2017-01-02T17:05:34.000Z</LastModified><ETag>&quot;ac1f7e1817c081dec04843bbf3ea6c0b&quot;</ETag><Size>50427056</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-5.2.0.tar.xz</Key><LastModified>2017-01-02T17:05:34.000Z</LastModified><ETag>&quot;addc7a2972b97e7328311f3f62cd5889&quot;</ETag><Size>50473488</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-5.3.0.tar.xz</Key><LastModified>2017-01-02T17:05:34.000Z</LastModified><ETag>&quot;c19d35992a471661e70191309f0528ae&quot;</ETag><Size>50894444</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-5.4.0.tar.xz</Key><LastModified>2017-01-02T17:05:35.000Z</LastModified><ETag>&quot;15f1739415390f9ba3d9ad6cf2874b85&quot;</ETag><Size>50757500</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-6.1.0.tar.xz</Key><LastModified>2017-01-02T17:05:36.000Z</LastModified><ETag>&quot;337f9192223b698e2b4e8c7d25358812&quot;</ETag><Size>55586956</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-6.2.0.tar.xz</Key><LastModified>2017-01-02T17:05:36.000Z</LastModified><ETag>&quot;de69678032b114f748529286baee785d&quot;</ETag><Size>55873476</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-6.3.0.tar.xz</Key><LastModified>2017-04-15T00:17:30.000Z</LastModified><ETag>&quot;4ae7427c3a389d85aac64c94018f09e8-6&quot;</ETag><Size>83139996</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-7.1.0.tar.xz</Key><LastModified>2017-05-02T17:48:30.000Z</LastModified><ETag>&quot;97031a46b8c8a32be653f43f4b2e329d-6&quot;</ETag><Size>89937640</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-7.2.0.tar.xz</Key><LastModified>2017-08-14T17:02:50.000Z</LastModified><ETag>&quot;9b09cab1158bc4d17e15f7d9de18390d-6&quot;</ETag><Size>89915872</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-trunk-20170920.tar.xz</Key><LastModified>2017-09-20T05:36:05.000Z</LastModified><ETag>&quot;86662727392fb6be2e0c65a11807a523-5&quot;</ETag><Size>66010604</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-trunk-20170921.tar.xz</Key><LastModified>2017-09-21T05:37:02.000Z</LastModified><ETag>&quot;2ddcdc738f80cf4ebb33c662ad40c93f-5&quot;</ETag><Size>65921888</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-trunk-20170922.tar.xz</Key><LastModified>2017-09-22T05:37:29.000Z</LastModified><ETag>&quot;53829479c8874648d4896f65fc05c6ab-5&quot;</ETag><Size>66379772</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-trunk-20170923.tar.xz</Key><LastModified>2017-09-23T05:38:29.000Z</LastModified><ETag>&quot;7e7aa0f0e13fb626290265c40b0aeb31-5&quot;</ETag><Size>66360884</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/gcc-trunk-20170924.tar.xz</Key><LastModified>2017-09-24T05:36:42.000Z</LastModified><ETag>&quot;097f369d023b32535ab97c7f3c966899-5&quot;</ETag><Size>66391596</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/ldc2-1.2.0.tar.xz</Key><LastModified>2017-06-19T14:00:46.000Z</LastModified><ETag>&quot;e2676b4fb7b4c09f94b15bff23588a19-15&quot;</ETag><Size>225483028</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/mips-gcc-5.4.0.tar.xz</Key><LastModified>2017-04-12T13:15:16.000Z</LastModified><ETag>&quot;906e6d3efa299f6f229e1e11b007780a-3&quot;</ETag><Size>38638376</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/mips64-gcc-5.4.0.tar.xz</Key><LastModified>2017-04-13T03:11:01.000Z</LastModified><ETag>&quot;29141889ca1d1c20f63ccaf1ffea570c-4&quot;</ETag><Size>56189780</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/mips64el-gcc-5.4.0.tar.xz</Key><LastModified>2017-04-13T04:22:46.000Z</LastModified><ETag>&quot;4b7fcf5183d76d96b4107722bcfe4dae-4&quot;</ETag><Size>56033708</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/mipsel-gcc-5.4.0.tar.xz</Key><LastModified>2017-04-13T00:21:03.000Z</LastModified><ETag>&quot;fb5a27781a6780ebcef462ef2d848f0a-3&quot;</ETag><Size>39020552</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/msp430-gcc-4.5.3.tar.xz</Key><LastModified>2017-04-10T12:51:33.000Z</LastModified><ETag>&quot;2c541fb9ea2fbcce93b0a94c591a8f72-4&quot;</ETag><Size>51104660</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/powerpc-gcc-4.8.5.tar.xz</Key><LastModified>2017-04-11T23:30:46.000Z</LastModified><ETag>&quot;c3605c5ed9382dfa3248b19917a1cda7-3&quot;</ETag><Size>31819356</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents><Contents><Key>opt/powerpc64le-gcc-6.3.0.tar.xz</Key><LastModified>2017-05-19T13:48:26.000Z</LastModified><ETag>&quot;6688a1128cef2e68b5500a670c555ffa-5&quot;</ETag><Size>66285048</Size><StorageClass>REDUCED_REDUNDANCY</StorageClass></Contents></ListBucketResult>
"""
    root = ET.fromstring(result)
    print "\n".join(
        sorted(key.text[len(args.prefix):] for key in
               root.findall('.//ns:Key', {'ns': 'http://s3.amazonaws.com/doc/2006-03-01/'})))


if __name__ == '__main__':
    parser = ArgumentParser()
    parser.add_argument('--s3url', help='S3 repo', default='https://s3.amazonaws.com/compiler-explorer')
    parser.add_argument('--prefix', help='List only using prefix', default='opt/')
    sys.exit(main(parser.parse_args()))
